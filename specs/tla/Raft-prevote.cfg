\* TLC configuration for Raft.tla (extensions config)
\*
\* Enables all Neumann extensions: PreVote, GeometricTiebreak, FastPath.
\* Tight bounds to keep state space tractable despite the additional
\* non-determinism from enabled extensions.
\*
\* Estimated: ~80-130M states, 15-30 min.
\* Run with: java -XX:+UseParallelGC -Xmx4g -jar tla2tools.jar \
\*   -deadlock -workers auto -config Raft-prevote.cfg Raft.tla

\* ========================================================================
\* Constants
\* ========================================================================

CONSTANTS
    n1 = n1
    n2 = n2
    n3 = n3
    v1 = v1
    Nil = Nil
    Nodes = {n1, n2, n3}
    MaxTerm = 2
    MaxLogLen = 1
    Values = {v1}
    SimilarityThreshold = 95
    MessageBound = 2
    EnablePreVote = TRUE
    EnableGeometricTiebreak = TRUE
    EnableFastPath = TRUE

\* ========================================================================
\* Specification
\* ========================================================================

SPECIFICATION Spec

\* ========================================================================
\* State Space Constraint
\* ========================================================================

CONSTRAINT StateConstraint

\* ========================================================================
\* Invariants (Safety Properties)
\* ========================================================================

INVARIANT TypeOK
INVARIANT ElectionSafety
INVARIANT LogMatching
INVARIANT StateMachineSafety
INVARIANT LeaderCompleteness
INVARIANT VoteIntegrity
INVARIANT PreVoteSafety
INVARIANT ReplicationInv

\* ========================================================================
\* Properties (Temporal)
\* ========================================================================

PROPERTY TermMonotonicity
PROPERTY CommittedLogAppendOnlyProp
PROPERTY MonotonicCommitIndexProp
PROPERTY MonotonicMatchIndexProp
PROPERTY NeverCommitEntryPrevTermsProp
PROPERTY StateTransitionsProp
PROPERTY PermittedLogChangesProp
